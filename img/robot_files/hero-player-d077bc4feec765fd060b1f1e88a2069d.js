function updateImageUrl(){window.updateUrlTimer&&clearTimeout(window.updateUrlTimer),window.updateUrlTimer=setTimeout(function(){window.product&&window.product.pushState()},500);var e={message:"imageChanged",view:window.lastView,type:window.lastViewType,availableFormats:window.lastViewAvailableFormats};$(document).trigger(e.message,e)}function imageChanged(e,n){"atlas"===e&&(window.spinnerTracking||(window.spinnerTracking=n),window.spinnerLoaded||(ga_product_spinner_event("loaded"),window.spinnerLoaded=!0),window.spinnerTracked||window.spinnerTracking===n||($(".object-caption").fadeOut(fadeTiming.fadeOutClickAndDrag,function(){$(".product-imagery").addClass("bordered"),$(".mobile-panel-space").animate({marginTop:"35px"},1e3)}),ga_product_spinner_event("spun"),heap_product_spinner_spun(gon.productId),window.spinnerTracked=!0),window.spinnerLoaded&&updateImageUrl());var i=player.getPlayer().getDownloadFormatsForView(n);window.product&&window.lastView!==n&&(window.lastView=n,window.lastViewAvailableFormats=i,window.lastViewType=e,window.product.setCurrentView(n))}function getPlayerSize(){var e=$(".product-main-column"),n=parseInt(e.css("padding-left"));n+=parseInt(e.css("padding-right")),n+=2;var i=parseInt($(".product-main-column").css("width")),a=i-n;return a=Math.min(a,600)}function onResize(){var e=getPlayerSize();$(".atlas").css("width",e),$(".atlas").css("height",e),window.player&&window.player.resizeWindow(e)}window.spinnerTracking=null,window.spinnerTracked=!1,window.spinnerLoaded=!1;var fadeTiming={fadeIn:500,fadeOut:100,fadeOutClickAndDrag:100};window.lastView=null,window.lastViewAvailableFormats=null,window.lastViewType=null,window.updateUrlTimer=null,window.parsedAsset||(window.parsedAsset=JSON.parse(gon.asset)),$(function(){productImagery=$(".product-imagery"),productImagery&&productImagery.length&&(onResize(),$(window).resize(function(){onResize()}),$("#controlArea").mouseup(function(){updateImageUrl()}),$(".dial").knob(),jQuery(".loading-progress").show(),ga_product_loaded("spinner only"))}),require(["atlas/AtlasThumbsPlayer"],function(e){function n(){window.player=new e(r,function(){"atlas"===gon.signatureImageType&&(player.displayViewer(gon.initialView,!0),imageChanged("atlas",gon.initialView))})}if(0!==$(".products-show, .products-spinner, .photoshop_plugins-index").length){var i=null;gon.startingImage&&(i={type:"atlas",view:gon.startingImage});var a=!1,t=new Date,o=gon.productId;"undefined"!=typeof ga&&ga("set","dimension1",o);var r={onAfterImageChanged:function(e,n){imageChanged("atlas",n)},onLoadingStarted:function(e){if($(".dial").val(0).trigger("change"),"0"!=$.cookie("first-spinner-load")&&($.cookie("first-spinner-load","0",{expires:365}),$(".tooltip").fadeIn(fadeTiming.fadeIn),d=!0),"undefined"!=typeof ga){var n=new Date-t;ga("set","dimension1",e),ga("set","metric1",n),ga("send","event","player","loaded",{nonInteraction:!0}),ga("set","metric1",0)}var a={message:"loadAsset",assetId:r.assetId,view:i.view};$(document).trigger(a.message,a)},onLoadingCompleted:function(e){$(".spinner-progress").fadeOut(fadeTiming.fadeOut),$(".spinner-progress-tip-area").hide(),d&&($(".tooltip").fadeOut(fadeTiming.fadeIn),d=!1);var n={message:"onLoadingComplete",assetId:e};$(document).trigger(n.message,n)},onInteractivityEnabled:function(){if($(".dial").val(0).trigger("change"),$(".spinner-progress").removeClass("single-latitude").addClass("multi-latitude"),$(".click-drag-tooltip").fadeIn(fadeTiming.fadeIn),a=!0,"undefined"!=typeof ga){var e=new Date-t;ga("set","metric2",e),ga_product_spinner_event("interactivity"),ga("set","metric2",0)}},onProgress:function(e){a?($(".tooltip.hero").html("Loading all camera angles"),$(".dial").val(100*e.imagePercentage).trigger("change")):$(".dial").val(100*e.interactivityPercentage).trigger("change");var n={message:"onProgress",assetId:o,interactivityEnabled:a,interactivityPercentage:e.interactivityPercentage,imagePercentage:e.imagePercentage};$(document).trigger(n.message,n)},onThumbnailClicked:function(e){if(e){if(a){var e=window.player.getPlayer().getCurrentImageIndex();imageChanged("atlas",e)}else imageChanged("atlas",gon.initialView),$(".loading-progress").show();"undefined"!=typeof ga&&(ga("set","dimension2",e),ga("send","event","thumbnail","click"),ga("set","dimension2",null))}},showLoadingSequenceTip:function(){},configurationUrl:"/hero_config",asset:window.parsedAsset,assetId:o,startingImage:i,displayingThumbnails:!1,priorityImages:gon.priorityImages,thumbnailClickIsDrag:!1,initialView:gon.initialView,alwaysSendLoadingSequenceEvents:!0,thumbnailClassSelector:".thumbnail-carousel-inner .thumbnail-outer",thumbnailStripClassSelector:".thumbnail-carousel",thumbnailSelectedClass:"selected-border",thumbnailRotatesViewer:!1,capabilities:{windowDimensions:{width:gon.windowWidth||600,height:gon.windowHeight||600}}},s=getPlayerSize();r.capabilities.windowDimensions.width=s,r.capabilities.windowDimensions.height=s,!Modernizr.hdpi&&gon.signatureImageUrl.indexOf("jpeg-1200")>-1?$.ajax({url:gon.productId+"/spinner_product?resolution=600"}).success(function(e){gon.asset=e,r.asset=e,n()}).error(function(){n()}):n();var d=!1;$(".spinner-progress-tip-area").bind({mouseover:function(){d||($(".tooltip").fadeIn(fadeTiming.fadeIn),d=!0)},mouseout:function(){d&&($(".tooltip").fadeOut(fadeTiming.fadeIn),d=!1)}}),$(".product-imagery").on("contextmenu",function(){return!1})}});